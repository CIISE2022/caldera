- tactic: reconnaissance
  technique_name: Active Scanning
  technique_id: T1595
  name: Suspicious PingCastle Execution - 14
  description: "Adapted from a Sigma rule. \n"
  executors:
  - name: psh
    platform: windows
    command: "$downloadUrl = \"https://github.com/netwrix/pingcastle/releases/download/3.4.1.38/PingCastle_3.4.1.38.zip\"\
      ; $zipPath = \"$env:TEMP\\PingCastle.zip\";\nif (-Not (Test-Path $zipPath))\
      \ {Write-Output \"Downloading PingCastle...\";Invoke-WebRequest -Uri $downloadUrl\
      \ -OutFile $zipPath} else {Write-Output \"PingCastle.zip already exists at $zipPath\"\
      };\n$suspiciousDir = \"$env:TEMP\"; \nif (-Not (Test-Path (Join-Path $env:TEMP\
      \ \"PingCastle.exe\"))) {Expand-Archive -Path $zipPath -DestinationPath $suspiciousDir\
      \ -Force}; \n$parentScript = \"$suspiciousDir\\launcher.ps1\";\n$pingcastleExe\
      \ = Join-Path $suspiciousDir \"PingCastle.exe\"; $pingcastleArgs = \"--scanner\
      \ spooler\"; \nSet-Content -Path $parentScript -Value (\"Start-Process -FilePath\
      \ '\" + $pingcastleExe + \"' -ArgumentList '\" + $pingcastleArgs + \"'\");\n\
      & $parentScript"
    code: null
    language: null
    build_target: null
    payloads: []
    uploads: []
    timeout: 60
    parsers: []
    cleanup: []
    variations: []
    additional_info: {}
  requirements: []
  privilege: ''
  repeatable: false
  buckets:
  - reconnaissance
  additional_info: {}
  access: {}
  singleton: false
  plugin: ''
  delete_payload: true
  selected: true
  id: 15b9ec5d-adbd-492b-a3e2-3515b179ee6b
